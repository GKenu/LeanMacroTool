<?xml version="1.0" encoding="UTF-8"?>
<customUI xmlns="http://schemas.microsoft.com/office/2009/07/customui" onLoad="Ribbon_OnLoad">
  <ribbon>
    <tabs>
      <tab id="LeanMacroTools" label="Lean Macros">
        <group id="grpFormatting" label="Number Formatting">
          <button id="btnCycleFormats"
                  label="Cycle Formats"
                  size="large"
                  imageMso="NumberFormatGallery"
                  onAction="CycleCustomNumberFormats"
                  screentip="Cycle Number Formats"
                  supertip="Cycle through custom number formats. Shortcut: Ctrl+Shift+N"/>
          <button id="btnCycleColors"
                  label="Cycle Colors"
                  size="large"
                  imageMso="FontColor"
                  onAction="CycleCustomColors"
                  screentip="Cycle Font Colors"
                  supertip="Cycle through preset font colors: Blue → Green → Red → Grey → Black → Original. Shortcut: Ctrl+Shift+V"/>
          <button id="btnCycleFill"
                  label="Cycle Fill"
                  size="large"
                  imageMso="CellFillColorPicker"
                  onAction="CycleFillFormats"
                  screentip="Cycle Fill Patterns"
                  supertip="Cycle through fill patterns: Color+Border → Pattern → Original. Shortcut: Ctrl+Shift+B"/>
        </group>
        <group id="grpTracing" label="Formula Tracing">
          <button id="btnTracePrecedents"
                  label="Trace Precedents"
                  size="large"
                  imageMso="TracePrecedents"
                  onAction="ShowLeanPrecedents"
                  screentip="Trace Precedents"
                  supertip="Show cells that feed into the current formula. Shortcut: Ctrl+Shift+T"/>
          <button id="btnTraceDependents"
                  label="Trace Dependents"
                  size="large"
                  imageMso="TraceDependents"
                  onAction="ShowLeanDependents"
                  screentip="Trace Dependents"
                  supertip="Show cells that use the current cell. Shortcut: Ctrl+Shift+Y"/>
        </group>
        <group id="grpExport" label="Export">
          <button id="btnExportPDF"
                  label="Export to PDF"
                  size="large"
                  imageMso="ExportToPDF"
                  onAction="ExportWorkbookToPDF"
                  screentip="Export to PDF"
                  supertip="Export entire workbook to PDF. One page per sheet, auto-fits used range, ignores print areas."/>
        </group>
        <group id="grpHelp" label="Help">
          <button id="btnHelp"
                  label="How to Use"
                  size="large"
                  imageMso="Help"
                  onAction="ShowHelp"
                  screentip="How to Use"
                  supertip="Quick guide to all Lean Macro Tools features and keyboard shortcuts."/>
        </group>
      </tab>
    </tabs>
  </ribbon>
</customUI>
